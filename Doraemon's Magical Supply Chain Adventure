<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– å¤šå•¦Aå¤¢çš„å•¤é…’éŠæˆ² | Doraemon's Beer Game ğŸº</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800;900&display=swap');
        
        :root {
            --doraemon-blue: #0066CC;
            --doraemon-light-blue: #4A90E2;
            --doraemon-white: #FFFFFF;
            --doraemon-red: #FF6B6B;
            --doraemon-yellow: #FFD93D;
            --doraemon-pink: #FF8FB1;
            --doraemon-green: #4ECDC4;
            --sky-blue: #87CEEB;
            --cloud-white: rgba(255, 255, 255, 0.9);
            --shadow-soft: 0 8px 32px rgba(0, 102, 204, 0.15);
            --shadow-medium: 0 12px 40px rgba(0, 102, 204, 0.2);
            --shadow-strong: 0 20px 60px rgba(0, 102, 204, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #B0E0E6 50%, #E0F6FF 100%);
            min-height: 100vh;
            padding: 15px;
            position: relative;
            overflow-x: hidden;
        }

        /* èƒŒæ™¯é›²æœµè£é£¾ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(ellipse 150px 50px at 20% 10%, var(--cloud-white) 40%, transparent 50%),
                radial-gradient(ellipse 100px 40px at 70% 15%, var(--cloud-white) 40%, transparent 50%),
                radial-gradient(ellipse 120px 45px at 90% 25%, var(--cloud-white) 40%, transparent 50%),
                radial-gradient(ellipse 180px 60px at 30% 80%, var(--cloud-white) 40%, transparent 50%),
                radial-gradient(ellipse 140px 50px at 80% 90%, var(--cloud-white) 40%, transparent 50%);
            animation: cloudFloat 20s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes cloudFloat {
            0%, 100% { transform: translateX(0px) translateY(0px); }
            25% { transform: translateX(10px) translateY(-5px); }
            50% { transform: translateX(-5px) translateY(5px); }
            75% { transform: translateX(-10px) translateY(-3px); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--cloud-white);
            border-radius: 30px;
            box-shadow: var(--shadow-strong);
            overflow: hidden;
            border: 3px solid var(--doraemon-blue);
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
        }

        /* å¤šå•¦Aå¤¢é ­éƒ¨è¨­è¨ˆ */
        .header {
            background: linear-gradient(135deg, var(--doraemon-blue), var(--doraemon-light-blue));
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: 'ğŸ¤–';
            position: absolute;
            font-size: 8rem;
            opacity: 0.1;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: headerIcon 3s ease-in-out infinite;
        }

        @keyframes headerIcon {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .doraemon-face {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .doraemon-head {
            width: 80px;
            height: 80px;
            background: var(--doraemon-blue);
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid white;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .doraemon-head::before {
            content: 'ğŸ‘ï¸';
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.2rem;
        }

        .doraemon-head::after {
            content: 'ğŸ‘ï¸';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.2rem;
        }

        .doraemon-nose {
            width: 12px;
            height: 12px;
            background: var(--doraemon-red);
            border-radius: 50%;
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            animation: noseGlow 1.5s ease-in-out infinite;
        }

        @keyframes noseGlow {
            0%, 100% { box-shadow: 0 0 5px var(--doraemon-red); }
            50% { box-shadow: 0 0 15px var(--doraemon-red); }
        }

        .title {
            font-size: 2.8rem;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            font-weight: 600;
            opacity: 0.95;
            margin-bottom: 15px;
        }

        .game-info {
            background: rgba(255,255,255,0.2);
            padding: 15px 25px;
            border-radius: 25px;
            display: inline-block;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .main-content {
            padding: 40px 30px;
            background: linear-gradient(135deg, #F0F8FF, #E6F3FF);
        }

        /* å¤šå•¦Aå¤¢é¢¨æ ¼çš„å€å¡Š */
        .doraemon-section {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            border: 3px solid var(--doraemon-blue);
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

        .doraemon-section::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            height: 8px;
            background: linear-gradient(90deg, 
                var(--doraemon-yellow) 0%, 
                var(--doraemon-pink) 25%, 
                var(--doraemon-green) 50%, 
                var(--doraemon-red) 75%, 
                var(--doraemon-blue) 100%);
            border-radius: 25px 25px 0 0;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--doraemon-blue);
        }

        .section-icon {
            width: 50px;
            height: 50px;
            background: var(--doraemon-yellow);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            animation: iconSpin 4s ease-in-out infinite;
            border: 3px solid var(--doraemon-blue);
        }

        @keyframes iconSpin {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
        }

        .bilingual-text {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .text-zh {
            font-weight: 700;
            color: var(--doraemon-blue);
        }

        .text-en {
            font-size: 0.9rem;
            color: var(--doraemon-light-blue);
            font-weight: 600;
        }

        /* é€²åº¦æ¢ - å¤šå•¦Aå¤¢é¢¨æ ¼ */
        .progress-container {
            background: var(--doraemon-blue);
            border-radius: 50px;
            height: 20px;
            overflow: hidden;
            border: 3px solid white;
            box-shadow: var(--shadow-soft);
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--doraemon-yellow), var(--doraemon-green));
            transition: width 1s ease;
            position: relative;
            border-radius: 50px;
        }

        .progress-fill::after {
            content: 'ğŸš';
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            animation: fly 2s ease-in-out infinite;
        }

        @keyframes fly {
            0%, 100% { transform: translateY(-50%) rotate(0deg); }
            50% { transform: translateY(-60%) rotate(10deg); }
        }

        .progress-text {
            text-align: center;
            margin-top: 15px;
            font-weight: 700;
            color: var(--doraemon-blue);
            font-size: 1.2rem;
        }

        /* çµ±è¨ˆå¡ç‰‡ - é“å…·é¢¨æ ¼ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, white, #F0F8FF);
            border-radius: 20px;
            padding: 25px 20px;
            text-align: center;
            border: 3px solid var(--doraemon-blue);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: var(--shadow-strong);
        }

        .stat-card::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
            animation: cardShine 3s ease-in-out infinite;
        }

        @keyframes cardShine {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .stat-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            filter: drop-shadow(3px 3px 6px rgba(0,0,0,0.2));
            animation: iconFloat 2s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--doraemon-blue);
            margin: 10px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .stat-label {
            font-weight: 700;
            color: var(--doraemon-light-blue);
            font-size: 0.95rem;
        }

        /* æˆæœ¬å¡ç‰‡ - ç´…åŒ…é¢¨æ ¼ */
        .cost-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .cost-card {
            background: linear-gradient(135deg, var(--doraemon-red), var(--doraemon-pink));
            color: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 3px solid white;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .cost-card:hover {
            transform: scale(1.05) rotate(1deg);
            box-shadow: var(--shadow-strong);
        }

        .cost-card::before {
            content: 'ğŸ’°';
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 2rem;
            opacity: 0.3;
            animation: coinSpin 3s linear infinite;
        }

        @keyframes coinSpin {
            from { transform: rotateY(0deg); }
            to { transform: rotateY(360deg); }
        }

        .cost-value {
            font-size: 2.8rem;
            font-weight: 900;
            margin: 15px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        /* è¼¸å…¥å€åŸŸ - ä»»æ„é–€é¢¨æ ¼ */
        .input-section {
            background: linear-gradient(135deg, white, #E6F3FF);
            border: 4px solid var(--doraemon-blue);
            border-radius: 25px;
            padding: 35px;
            position: relative;
        }

        .input-section::before {
            content: 'ğŸšª';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            background: var(--doraemon-pink);
            padding: 10px 15px;
            border-radius: 50%;
            border: 3px solid var(--doraemon-blue);
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-group {
            text-align: center;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: var(--doraemon-blue);
            font-size: 1rem;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            border: 3px solid var(--doraemon-light-blue);
            border-radius: 20px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            background: linear-gradient(135deg, white, #F0F8FF);
            transition: all 0.3s ease;
            color: var(--doraemon-blue);
        }

        .input-group input:focus {
            border-color: var(--doraemon-yellow);
            outline: none;
            box-shadow: 0 0 0 4px rgba(255, 215, 61, 0.3);
            transform: scale(1.05);
            background: white;
        }

        .input-group input:hover:not(:focus) {
            border-color: var(--doraemon-green);
            transform: translateY(-2px);
        }

        #myOrder {
            border-color: var(--doraemon-red) !important;
            background: linear-gradient(135deg, #FFF0F0, white) !important;
            font-weight: 900 !important;
        }

        #myOrder:focus {
            border-color: var(--doraemon-yellow) !important;
            box-shadow: 0 0 0 4px rgba(255, 107, 107, 0.3) !important;
        }

        /* æŒ‰éˆ• - é“å…·æŒ‰éˆ•é¢¨æ ¼ */
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .doraemon-btn {
            padding: 18px 35px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
            min-width: 160px;
            border: 3px solid white;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .doraemon-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .doraemon-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .doraemon-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: var(--shadow-strong);
        }

        .doraemon-btn:active {
            transform: translateY(-2px) scale(1.02);
        }

        .btn-ai {
            background: linear-gradient(135deg, var(--doraemon-green), var(--sky-blue));
            color: white;
        }

        .btn-process {
            background: linear-gradient(135deg, var(--doraemon-blue), var(--doraemon-light-blue));
            color: white;
        }

        .btn-reset {
            background: linear-gradient(135deg, var(--doraemon-yellow), var(--doraemon-red));
            color: white;
        }

        /* AIå»ºè­°å€åŸŸ - æ™‚å…‰æ©Ÿé¢¨æ ¼ */
        .ai-suggestion {
            background: linear-gradient(135deg, var(--doraemon-green), var(--sky-blue));
            color: white;
            border-radius: 25px;
            padding: 35px;
            margin-bottom: 30px;
            display: none;
            position: relative;
            overflow: hidden;
            border: 3px solid white;
        }

        .ai-suggestion::before {
            content: 'ğŸ”®';
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2.5rem;
            animation: crystal 2s ease-in-out infinite;
        }

        @keyframes crystal {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }

        .suggestion-content {
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }

        /* æ­·å²è¨˜éŒ„ - è¨˜æ†¶åå¸é¢¨æ ¼ */
        .history-section {
            background: linear-gradient(135deg, #FFFACD, #F0F8FF);
            border: 4px solid var(--doraemon-blue);
            border-radius: 25px;
            padding: 35px;
            position: relative;
            overflow: hidden;
        }

        .history-section::before {
            content: 'ğŸ“œ';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            background: var(--doraemon-yellow);
            padding: 10px;
            border-radius: 50%;
            border: 3px solid var(--doraemon-blue);
        }

        .table-container {
            overflow-x: auto;
            border-radius: 15px;
            margin-top: 20px;
            border: 2px solid var(--doraemon-blue);
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 0.9rem;
        }

        .history-table th {
            background: linear-gradient(135deg, #87CEEB, #B0E0E6);
            color: var(--doraemon-blue);
            padding: 15px 8px;
            text-align: center;
            font-weight: 800;
            position: sticky;
            top: 0;
            z-index: 1;
            border-right: 2px solid white;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }

        .history-table td {
            padding: 12px 8px;
            text-align: center;
            border-bottom: 1px solid var(--doraemon-light-blue);
            border-right: 1px solid #E6F3FF;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .history-table tbody tr:nth-child(even) {
            background: #F0F8FF;
        }

        .history-table tbody tr:hover {
            background: var(--doraemon-yellow);
            transform: scale(1.02);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* æ‡¸æµ®æŒ‰éˆ• - ç«¹èœ»èœ“é¢¨æ ¼ */
        .floating-actions {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 1000;
        }

        .floating-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            border: 4px solid white;
            position: relative;
            overflow: hidden;
        }

        .floating-btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            animation: floatingGlow 2s ease-in-out infinite;
        }

        @keyframes floatingGlow {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }

        .floating-btn:hover {
            transform: scale(1.2) rotate(10deg);
            box-shadow: var(--shadow-strong);
        }

        .floating-btn.help {
            background: linear-gradient(135deg, var(--doraemon-yellow), var(--doraemon-red));
        }

        .floating-btn.scroll-top {
            background: linear-gradient(135deg, var(--doraemon-blue), var(--doraemon-light-blue));
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .container {
                margin: 5px;
                border-radius: 20px;
            }
            
            .main-content {
                padding: 25px 20px;
            }
            
            .title {
                font-size: 2.2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
                gap: 12px;
            }

            .doraemon-btn {
                min-width: auto;
                width: 100%;
            }

            .floating-actions {
                bottom: 20px;
                right: 15px;
            }

            .floating-btn {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
        }

        /* ç‰¹æ•ˆå‹•ç•« */
        .animate-in {
            animation: slideInUp 0.8s ease-out forwards;
            opacity: 0;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* è¦å‰‡å€åŸŸç‰¹æ®Šæ¨£å¼ */
        .rules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .rule-card {
            background: linear-gradient(135deg, white, #F0F8FF);
            border: 3px solid var(--doraemon-light-blue);
            border-radius: 20px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .rule-card:hover {
            transform: translateY(-5px);
            border-color: var(--doraemon-yellow);
            box-shadow: var(--shadow-medium);
        }

        .rule-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--doraemon-yellow), var(--doraemon-pink));
        }

        .rule-title {
            font-weight: 800;
            color: var(--doraemon-blue);
            margin-bottom: 12px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rule-emoji {
            font-size: 1.5rem;
            animation: ruleFloat 2s ease-in-out infinite;
        }

        @keyframes ruleFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }

        /* åŠ è¼‰å‹•ç•« */
        .loading {
            opacity: 0;
        }

        .loaded {
            opacity: 1;
            transition: opacity 0.8s ease-in-out;
        }

        /* è­¦å‘Šæç¤ºæ¡† */
        .doraemon-alert {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--doraemon-yellow);
            color: var(--doraemon-blue);
            padding: 15px 25px;
            border-radius: 25px;
            border: 3px solid var(--doraemon-blue);
            z-index: 10000;
            font-weight: 800;
            box-shadow: var(--shadow-strong);
            animation: alertBounce 0.5s ease-out;
        }

        @keyframes alertBounce {
            0% { transform: translateX(-50%) translateY(-100px); }
            100% { transform: translateX(-50%) translateY(0); }
        }
    </style>
</head>
<body class="loading">
    <div class="container">
        <!-- å¤šå•¦Aå¤¢é¢¨æ ¼é ­éƒ¨ -->
        <header class="header">
            <div class="header-content">
                <div class="doraemon-face">
                    <div class="doraemon-head">
                        <div class="doraemon-nose"></div>
                    </div>
                </div>
                <h1 class="title">ğŸ¤– å¤šå•¦Aå¤¢çš„å•¤é…’éŠæˆ² ğŸº</h1>
                <div class="subtitle">Doraemon's Magical Supply Chain Adventure | å¤šå•¦Aå¤¢çš„ç¥å¥‡ä¾›æ‡‰éˆå†’éšª</div>
                <div class="game-info">
                    <i class="fas fa-user-tie"></i> ç¶“éŠ·å•†è§’è‰² Distributor Role 
                    <span style="margin: 0 15px;">â€¢</span>
                    <i class="fas fa-target"></i> ç›®æ¨™ï¼šç”¨ç¥å¥‡é“å…·æœ€å°åŒ–æˆæœ¬ï¼Goal: Minimize costs with magical tools!
                </div>
            </div>
        </header>

        <main class="main-content">
            <!-- é€²åº¦å€åŸŸ - æ™‚å…‰éš§é“ -->
            <div class="doraemon-section animate-in">
                <div class="section-title">
                    <div class="section-icon">ğŸš</div>
                    <div class="bilingual-text">
                        <span class="text-zh">æ™‚å…‰éš§é“é€²åº¦</span>
                        <span class="text-en">Time Tunnel Progress</span>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
                <div class="progress-text" id="progressText">Week 0 / 60 | ç¬¬0é€± / 60é€±</div>
            </div>

            <!-- éŠæˆ²è¦å‰‡ - ç™¾ç§‘å…¨æ›¸ -->
            <div class="doraemon-section animate-in">
                <div class="section-title">
                    <div class="section-icon">ğŸ“š</div>
                    <div class="bilingual-text">
                        <span class="text-zh">å¤šå•¦Aå¤¢ç™¾ç§‘å…¨æ›¸</span>
                        <span class="text-en">Doraemon's Encyclopedia</span>
                    </div>
                </div>
                <div class="rules-grid">
                    <div class="rule-card">
                        <div class="rule-title">
                            <span class="rule-emoji">ğŸ’°</span>
                            <div class="bilingual-text">
                                <span class="text-zh">ç¥å¥‡è¨ˆç®—å™¨æˆæœ¬å…¬å¼</span>
                                <span class="text-en">Magic Calculator Cost Formula</span>
                            </div>
                        </div>
                        <div class="bilingual-text">
                            <span class="text-zh">åº«å­˜æˆæœ¬ 0.5å…ƒ/å–®ä½/é€±ï¼Œç¼ºè²¨æˆæœ¬ 1å…ƒ/å–®ä½/é€±</span>
                            <span class="text-en">Inventory: $0.5/unit/week, Shortage: $1.0/unit/week</span>
                        </div>
                    </div>
                    <div class="rule-card">
                        <div class="rule-title">
                            <span class="rule-emoji">ğŸ§®</span>
                            <div class="bilingual-text">
                                <span class="text-zh">ç¸½æˆæœ¬é­”æ³•å…¬å¼</span>
                                <span class="text-en">Total Cost Magic Formula</span>
                            </div>
                        </div>
                        <div class="bilingual-text">
                            <span class="text-zh">(åº«å­˜+å»¶é²1+å»¶é²2) Ã— 0.5 + ç¼ºè²¨é‡ Ã— 1.0</span>
                            <span class="text-en">(Inventory + Delay1 + Delay2) Ã— 0.5 + Shortage Ã— 1.0</span>
                        </div>
                    </div>
                    <div class="rule-card">
                        <div class="rule-title">
                            <span class="rule-emoji">ğŸš€</span>
                            <div class="bilingual-text">
                                <span class="text-zh">æ™‚å…‰æ©Ÿå»¶é²ç³»çµ±</span>
                                <span class="text-en">Time Machine Delay System</span>
                            </div>
                        </div>
                        <div class="bilingual-text">
                            <span class="text-zh">è²¨ç‰©ç©¿è¶Šæ™‚ç©ºï¼šå»¶é²2 â†’ å»¶é²1 â†’ åº«å­˜</span>
                            <span class="text-en">Goods time travel: Delay2 â†’ Delay1 â†’ Inventory</span>
                        </div>
                    </div>
                    <div class="rule-card">
                        <div class="rule-title">
                            <span class="rule-emoji">âš ï¸</span>
                            <div class="bilingual-text">
                                <span class="text-zh">è­¦å ±å™¨ç¼ºè²¨æé†’</span>
                                <span class="text-en">Alarm for Shortage Alert</span>
                            </div>
                        </div>
                        <div class="bilingual-text">
                            <span class="text-zh">ç¼ºè²¨æœƒè§¸ç™¼è­¦å ±ï¼Œç”¢ç”Ÿé›™å€æ‡²ç½°æˆæœ¬</span>
                            <span class="text-en">Shortages trigger alarms with double penalty costs</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é“å…·ç‹€æ…‹ç›£æ§ -->
            <div class="doraemon-section animate-in">
                <div class="section-title">
                    <div class="section-icon">ğŸ“Š</div>
                    <div class="bilingual-text">
                        <span class="text-zh">ç¥å¥‡é“å…·ç‹€æ…‹ç›£æ§</span>
                        <span class="text-en">Magical Tools Status Monitor</span>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ•</div>
                        <div class="stat-value" id="currentWeek">0</div>
                        <div class="stat-label">
                            <div class="bilingual-text">
                                <span class="text-zh">ç•¶å‰é€±æ•¸ (Current Week)</span>
                                <span class="text-en">éŠæˆ²é€²è¡Œçš„é€±æ•¸</span>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“¦</div>
                        <div class="stat-value" id="inventory">4</div>
                        <div class="stat-label">
                            <div class="bilingual-text">
                                <span class="text-zh">åº«å­˜é‡ (Inventory)</span>
                                <span class="text-en">å¯ç«‹å³å‡ºè²¨çš„å•†å“æ•¸é‡</span>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">â°</div>
                        <div class="stat-value" id="delay1">4</div>
                        <div class="stat-label">
                            <div class="bilingual-text">
                                <span class="text-zh">å»¶é²1 (Delay 1)</span>
                                <span class="text-en">ä¸‹é€±æœƒåˆ°é”çš„è²¨ç‰©</span>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">âŒ›</div>
                        <div class="stat-value" id="delay2">4</div>
                        <div class="stat-label">
                            <div class="bilingual-text">
                                <span class="text-zh">å»¶é²2 (Delay 2)</span>
                                <span class="text-en">å…©é€±å¾Œæœƒåˆ°é”çš„è²¨ç‰©</span>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸš¨</div>
                        <div class="stat-value" id="backorder">0</div>
                        <div class="stat-label">
                            <div class="bilingual-text">
                                <span class="text-zh">ç¼ºè²¨é‡ (Shortage)</span>
                                <span class="text-en">ç„¡æ³•æ»¿è¶³çš„è¨‚å–®æ•¸é‡</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æˆæœ¬æ°´æ™¶çƒ -->
            <div class="doraemon-section animate-in">
                <div class="section-title">
                    <div class="section-icon">ğŸ”®</div>
                    <div class="bilingual-text">
                        <span class="text-zh">é çŸ¥æ°´æ™¶çƒæˆæœ¬åˆ†æ</span>
                        <span class="text-en">Fortune Crystal Ball Cost Analysis</span>
                    </div>
                </div>
                <div class="cost-cards">
                    <div class="cost-card">
                        <div class="bilingual-text">
                            <span class="text-zh">æœ¬é€±æˆæœ¬ (Weekly Cost)</span>
                            <span class="text-en">æœ¬é€±ç”¢ç”Ÿçš„ç¸½æˆæœ¬</span>
                        </div>
                        <div class="cost-value" id="weeklyCost">6.0</div>
                        <small>å…ƒ / Dollars</small>
                    </div>
                    <div class="cost-card">
                        <div class="bilingual-text">
                            <span class="text-zh">ç´¯ç©ç¸½æˆæœ¬ (Total Cost)</span>
                            <span class="text-en">å¾é–‹å§‹ç´¯ç©çš„ç¸½æˆæœ¬</span>
                        </div>
                        <div class="cost-value" id="totalCost">6.0</div>
                        <small>å…ƒ / Dollars</small>
                    </div>
                </div>
            </div>

            <!-- ä»»æ„é–€æ•¸æ“šè¼¸å…¥ -->
            <div class="doraemon-section animate-in">
                <div class="input-section">
                    <div class="section-title">
                        <div class="section-icon">ğŸšª</div>
                        <div class="bilingual-text">
                            <span class="text-zh">ä»»æ„é–€æ•¸æ“šè¼¸å…¥å€</span>
                            <span class="text-en">Anywhere Door Data Input Zone</span>
                        </div>
                    </div>
                    
                    <!-- åŸºç¤æ•¸æ“šè¼¸å…¥ -->
                    <h3 style="color: var(--doraemon-blue); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <span>ğŸ“Š æœ¬é€±ç™¼ç”Ÿçš„äº‹å¯¦æ•¸æ“š | Weekly Facts Data</span>
                    </h3>
                    <div class="input-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                        <div class="input-group">
                            <label>
                                <div class="bilingual-text">
                                    <span class="text-zh">ğŸª æ‰¹ç™¼å•†è¨‚å–® (Wholesaler Order)</span>
                                    <span class="text-en">æ‰¹ç™¼å•†å‘æ‚¨ä¸‹çš„è¨‚å–®æ•¸é‡</span>
                                </div>
                            </label>
                            <input type="number" id="wholesalerOrder" min="0" placeholder="æ•¸é‡">
                        </div>
                        <div class="input-group">
                            <label>
                                <div class="bilingual-text">
                                    <span class="text-zh">ğŸšš å¯¦éš›å‡ºè²¨é‡ (Actual Shipment)</span>
                                    <span class="text-en">æ‚¨å¯¦éš›å‡ºè²¨çš„æ•¸é‡</span>
                                </div>
                            </label>
                            <input type="number" id="actualShip" min="0" placeholder="æ•¸é‡">
                        </div>
                        <div class="input-group">
                            <label>
                                <div class="bilingual-text">
                                    <span class="text-zh">ğŸ“¦ æ›´æ–°åº«å­˜ (Updated Inventory)</span>
                                    <span class="text-en">æœ¬é€±çµæŸå¾Œçš„åº«å­˜æ•¸é‡</span>
                                </div>
                            </label>
                            <input type="number" id="newInventory" min="0" placeholder="æ•¸é‡">
                        </div>
                        <div class="input-group">
                            <label>
                                <div class="bilingual-text">
                                    <span class="text-zh">â° æ›´æ–°å»¶é²1 (Updated Delay1)</span>
                                    <span class="text-en">ä¸‹é€±æœƒåˆ°é”çš„è²¨ç‰©æ•¸é‡</span>
                                </div>
                            </label>
                            <input type="number" id="newDelay1" min="0" placeholder="æ•¸é‡">
                        </div>
                        <div class="input-group">
                            <label>
                                <div class="bilingual-text">
                                    <span class="text-zh">âŒ› æ›´æ–°å»¶é²2 (Updated Delay2)</span>
                                    <span class="text-en">å…©é€±å¾Œæœƒåˆ°é”çš„è²¨ç‰©æ•¸é‡</span>
                                </div>
                            </label>
                            <input type="number" id="newDelay2" min="0" placeholder="æ•¸é‡">
                        </div>
                    </div>

                    <!-- AIå»ºè­°æŒ‰éˆ• -->
                    <div style="text-align: center; margin: 30px 0;">
                        <button class="doraemon-btn btn-ai" onclick="getAISuggestion()" style="font-size: 1.1rem; padding: 20px 40px;">
                            <i class="fas fa-robot"></i>
                            <div style="margin-left: 8px;">
                                ğŸ”® AIæ™ºèƒ½å»ºè­°<br>AI Magic Advice
                            </div>
                        </button>
                        <p style="margin-top: 10px; color: var(--doraemon-light-blue); font-weight: 600;">
                            ğŸ’¡ å»ºè­°å…ˆç²å–AIç­–ç•¥åˆ†æï¼Œå†æ±ºå®šè¨‚è³¼æ•¸é‡<br>
                            ğŸ’¡ Get AI strategy analysis first, then decide order quantity
                        </p>
                    </div>

                    <!-- æ±ºç­–è¼¸å…¥å€ -->
                    <div style="background: linear-gradient(135deg, #FFF0F0, #FFE6E6); border: 3px solid var(--doraemon-red); border-radius: 20px; padding: 25px; margin-top: 30px; position: relative;">
                        <div style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); background: var(--doraemon-red); color: white; padding: 8px 20px; border-radius: 20px; font-weight: 800; font-size: 0.9rem;">
                            ğŸ¯ é‡è¦æ±ºç­– Important Decision
                        </div>
                        
                        <h3 style="color: var(--doraemon-red); margin-bottom: 20px; display: flex; align-items: center; gap: 10px; justify-content: center; margin-top: 10px;">
                            <span>ğŸ§  åŸºæ–¼åˆ†æçš„ç­–ç•¥æ±ºç­– | Strategic Decision Based on Analysis</span>
                        </h3>
                        
                        <div class="input-group" style="max-width: 300px; margin: 0 auto;">
                            <label>
                                <div class="bilingual-text">
                                    <span class="text-zh">ğŸ­ æˆ‘çš„å·¥å» è¨‚å–® (My Factory Order)</span>
                                    <span class="text-en">åŸºæ–¼AIå»ºè­°ï¼Œæ‚¨è¦å‘å·¥å» è¨‚è³¼çš„æ•¸é‡</span>
                                </div>
                            </label>
                            <input type="number" id="myOrder" min="0" placeholder="è¨‚è³¼é‡" style="border-color: var(--doraemon-red) !important; font-size: 1.4rem !important; font-weight: 900 !important;">
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px;">
                            <p style="color: var(--doraemon-red); font-weight: 700; font-size: 0.9rem;">
                                âš ï¸ é€™å€‹æ±ºç­–å°‡å½±éŸ¿æœªä¾†å¹¾é€±çš„åº«å­˜å’Œæˆæœ¬<br>
                                âš ï¸ This decision will affect future weeks' inventory and costs
                            </p>
                        </div>
                    </div>

                    <!-- åŸ·è¡ŒæŒ‰éˆ• -->
                    <div class="button-group" style="margin-top: 30px;">
                        <button class="doraemon-btn btn-process" onclick="processWeek()">
                            <i class="fas fa-magic"></i>
                            <div style="margin-left: 8px;">
                                âœ¨ æ–½å±•é­”æ³•<br>Cast Magic
                            </div>
                        </button>
                        <button class="doraemon-btn btn-reset" onclick="resetGame()">
                            <i class="fas fa-redo-alt"></i>
                            <div style="margin-left: 8px;">
                                ğŸŒ€ æ™‚å…‰é‡ç½®<br>Time Reset
                            </div>
                        </button>
                    </div>
                </div>
            </div>

            <!-- AIå åœå€åŸŸ -->
            <div class="ai-suggestion" id="aiSuggestion">
                <div class="section-title" style="color: white; margin-bottom: 20px;">
                    <div class="section-icon" style="background: rgba(255,255,255,0.3);">ğŸ”®</div>
                    <div class="bilingual-text">
                        <span class="text-zh">å¤šå•¦Aå¤¢AIæ™ºèƒ½å åœ</span>
                        <span class="text-en">Doraemon AI Fortune Telling</span>
                    </div>
                </div>
                <div class="suggestion-content" id="suggestionContent">
                    <!-- AIå»ºè­°å…§å®¹å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>

            <!-- è¨˜æ†¶åå¸æ­·å²è¨˜éŒ„ -->
            <div class="doraemon-section animate-in">
                <div class="history-section">
                    <div class="section-title">
                        <div class="section-icon">ğŸ“œ</div>
                        <div class="bilingual-text">
                            <span class="text-zh">è¨˜æ†¶åå¸æ­·å²è¨˜éŒ„</span>
                            <span class="text-en">Memory Bread History Records</span>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">é€±æ•¸</span>
                                            <span class="text-en">Week</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">æ‰¹ç™¼å•†è¨‚å–®</span>
                                            <span class="text-en">Wholesaler Order</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">å¯¦éš›å‡ºè²¨</span>
                                            <span class="text-en">Actual Ship</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">æˆ‘çš„è¨‚å–®</span>
                                            <span class="text-en">My Order</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">åº«å­˜</span>
                                            <span class="text-en">Inventory</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">å»¶é²1</span>
                                            <span class="text-en">Delay1</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">å»¶é²2</span>
                                            <span class="text-en">Delay2</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">ç¼ºè²¨</span>
                                            <span class="text-en">Shortage</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">é€±æˆæœ¬</span>
                                            <span class="text-en">Week Cost</span>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="bilingual-text">
                                            <span class="text-zh">ç´¯ç©æˆæœ¬</span>
                                            <span class="text-en">Total Cost</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <tr>
                                    <td>0</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>4</td>
                                    <td>4</td>
                                    <td>4</td>
                                    <td>0</td>
                                    <td>6.0</td>
                                    <td>6.0</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ç«¹èœ»èœ“æ‡¸æµ®æŒ‰éˆ• -->
    <div class="floating-actions">
        <div class="floating-btn help" onclick="showGameHelp()" title="å¤šå•¦Aå¤¢å¹«åŠ© Doraemon Help">
            ğŸ¤–
        </div>
        <div class="floating-btn scroll-top" onclick="scrollToTop()" title="ç«¹èœ»èœ“å›é ‚éƒ¨ Bamboo-copter to Top">
            ğŸš
        </div>
    </div>

    <script>
        // éŠæˆ²ç‹€æ…‹ç®¡ç†
        let gameState = {
            currentWeek: 0,
            inventory: 4,
            delay1: 4,
            delay2: 4,
            backorder: 0,
            weeklyCost: 6.0,
            totalCost: 6.0,
            history: []
        };

        // é é¢è¼‰å…¥åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // è¼‰å…¥å‹•ç•«
            setTimeout(() => {
                document.body.classList.remove('loading');
                document.body.classList.add('loaded');
                
                // ä¾åºé¡¯ç¤ºå‹•ç•«
                const elements = document.querySelectorAll('.animate-in');
                elements.forEach((el, index) => {
                    setTimeout(() => {
                        el.style.animationDelay = `${index * 0.1}s`;
                    }, index * 100);
                });
            }, 500);

            // è¨­å®šç¬¬ä¸€é€±é è¨­æ•¸æ“š
            setDefaultWeekData();
            updateDisplay();
            updateProgressBar();
        });

        function setDefaultWeekData() {
            document.getElementById('wholesalerOrder').value = 0;
            document.getElementById('actualShip').value = 0;
            document.getElementById('myOrder').value = '';  // ä¿æŒç©ºç™½ï¼Œè®“ç”¨æˆ¶æ±ºç­–
            document.getElementById('newInventory').value = 8;
            document.getElementById('newDelay1').value = 4;
            document.getElementById('newDelay2').value = 0;
        }

        function calculateCost(inventory, delay1, delay2, backorder) {
            const inventoryCost = (inventory + delay1 + delay2) * 0.5;
            const backorderCost = backorder * 1.0;
            return inventoryCost + backorderCost;
        }

        function updateDisplay() {
            // æ›´æ–°æ•¸å€¼é¡¯ç¤ºä¸¦æ·»åŠ å¤šå•¦Aå¤¢é¢¨æ ¼å‹•ç•«
            const elements = ['currentWeek', 'inventory', 'delay1', 'delay2', 'backorder', 'weeklyCost', 'totalCost'];
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                const currentValue = element.textContent;
                let newValue;
                
                switch(id) {
                    case 'currentWeek':
                        newValue = gameState.currentWeek;
                        break;
                    case 'inventory':
                        newValue = gameState.inventory;
                        break;
                    case 'delay1':
                        newValue = gameState.delay1;
                        break;
                    case 'delay2':
                        newValue = gameState.delay2;
                        break;
                    case 'backorder':
                        newValue = gameState.backorder;
                        break;
                    case 'weeklyCost':
                        newValue = gameState.weeklyCost.toFixed(1);
                        break;
                    case 'totalCost':
                        newValue = gameState.totalCost.toFixed(1);
                        break;
                }
                
                if (currentValue !== newValue.toString()) {
                    element.style.transform = 'scale(1.2) rotate(5deg)';
                    element.style.color = 'var(--doraemon-red)';
                    setTimeout(() => {
                        element.textContent = newValue;
                        element.style.transform = 'scale(1) rotate(0deg)';
                        element.style.color = '';
                    }, 200);
                }
            });
        }

        function updateProgressBar() {
            const progress = (gameState.currentWeek / 60) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Week ${gameState.currentWeek} / 60 | ç¬¬${gameState.currentWeek}é€± / 60é€± ğŸš`;
        }

        function getAISuggestion() {
            const wholesalerOrder = parseInt(document.getElementById('wholesalerOrder').value) || 0;
            const actualShip = parseInt(document.getElementById('actualShip').value) || 0;
            const newInventory = parseInt(document.getElementById('newInventory').value) || 0;
            const newDelay1 = parseInt(document.getElementById('newDelay1').value) || 0;
            const newDelay2 = parseInt(document.getElementById('newDelay2').value) || 0;

            // æª¢æŸ¥åŸºç¤æ•¸æ“šæ˜¯å¦å·²è¼¸å…¥
            if (isNaN(wholesalerOrder) || isNaN(actualShip) || isNaN(newInventory) || isNaN(newDelay1) || isNaN(newDelay2)) {
                showDoraemonAlert('ğŸ¤– å¤šå•¦Aå¤¢æé†’ï¼šè«‹å…ˆå¡«å…¥ä¸Šæ–¹çš„äº‹å¯¦æ•¸æ“šï¼\nDoraemon reminds: Please fill in the facts data above first!', 'warning');
                return;
            }

            const newBackorder = Math.max(0, gameState.backorder + wholesalerOrder - actualShip);
            
            let suggestion = generateDoraemonAISuggestion(wholesalerOrder, newInventory, newDelay1, newDelay2, newBackorder);
            
            document.getElementById('suggestionContent').innerHTML = suggestion;
            document.getElementById('aiSuggestion').style.display = 'block';
            
            // å¹³æ»‘æ»¾å‹•åˆ°AIå»ºè­°å€åŸŸ
            document.getElementById('aiSuggestion').scrollIntoView({ 
                behavior: 'smooth',
                block: 'center'
            });
        }

        function applySuggestedOrder(suggestedOrder) {
            document.getElementById('myOrder').value = suggestedOrder;
            
            // è¦–è¦ºåé¥‹ - è®“è¼¸å…¥æ¡†é–ƒçˆä¸€ä¸‹
            const orderInput = document.getElementById('myOrder');
            orderInput.style.background = 'linear-gradient(135deg, var(--doraemon-yellow), #FFE6B3)';
            orderInput.style.transform = 'scale(1.1)';
            orderInput.style.boxShadow = '0 0 20px rgba(255, 215, 61, 0.6)';
            
            setTimeout(() => {
                orderInput.style.background = '';
                orderInput.style.transform = '';
                orderInput.style.boxShadow = '';
            }, 1000);
            
            // é¡¯ç¤ºæˆåŠŸæç¤º
            showDoraemonAlert(`âœ… AIå»ºè­°å·²æ¡ç”¨ï¼è¨‚è³¼æ•¸é‡è¨­ç‚º ${suggestedOrder}\nâœ… AI suggestion applied! Order quantity set to ${suggestedOrder}`, 'success');
            
            // æ»¾å‹•åˆ°è¨‚å–®è¼¸å…¥å€åŸŸ
            document.getElementById('myOrder').scrollIntoView({ 
                behavior: 'smooth',
                block: 'center'
            });
        }

        function generateDoraemonAISuggestion(wholesalerOrder, inventory, delay1, delay2, backorder) {
            let totalInPipeline = delay1 + delay2;
            let suggestedOrder = 0;
            let reasoning = "";

            // è¨ˆç®—æ­·å²å¹³å‡éœ€æ±‚
            let recentDemands = gameState.history.slice(-4).map(h => h.wholesalerOrder);
            let avgDemand = recentDemands.length > 0 ? 
                recentDemands.reduce((a, b) => a + b, 0) / recentDemands.length : wholesalerOrder;

            let targetInventory = Math.ceil(avgDemand * 2);

            // å¤šå•¦Aå¤¢é¢¨æ ¼çš„AIå»ºè­°
            if (backorder > 0) {
                suggestedOrder = backorder + wholesalerOrder + targetInventory - totalInPipeline;
                reasoning = generateDoraemonShortageStrategy(backorder, wholesalerOrder, targetInventory, totalInPipeline, suggestedOrder);
            } else if (inventory < targetInventory) {
                let shortfall = targetInventory - inventory;
                suggestedOrder = Math.max(0, shortfall + avgDemand - totalInPipeline);
                reasoning = generateDoraemonReplenishmentStrategy(shortfall, avgDemand, totalInPipeline, suggestedOrder);
            } else if (inventory > targetInventory * 1.5) {
                suggestedOrder = Math.max(0, Math.ceil(avgDemand * 0.5) - totalInPipeline);
                reasoning = generateDoraemonCostControlStrategy(inventory, avgDemand, totalInPipeline, suggestedOrder);
            } else {
                suggestedOrder = Math.max(0, Math.ceil(avgDemand) - totalInPipeline + (targetInventory - inventory));
                reasoning = generateDoraemonStableStrategy(avgDemand, targetInventory, inventory, totalInPipeline, suggestedOrder);
            }

            let currentCost = calculateCost(inventory, delay1, delay2, backorder);
            let costAnalysis = generateDoraemonCostAnalysis(currentCost, inventory, delay1, delay2, backorder);
            
            let actionButton = `
                <div style="margin-top: 30px; text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px; border: 2px solid rgba(255,255,255,0.3);">
                    <button onclick="applySuggestedOrder(${suggestedOrder})" style="
                        background: linear-gradient(135deg, var(--doraemon-yellow), var(--doraemon-red));
                        color: white;
                        border: none;
                        padding: 15px 30px;
                        border-radius: 25px;
                        font-size: 1.2rem;
                        font-weight: 800;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        border: 3px solid white;
                        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        âœ¨ æ¡ç”¨å»ºè­°ï¼šè¨‚è³¼ ${suggestedOrder} å–®ä½<br>
                        âœ¨ Apply Suggestion: Order ${suggestedOrder} Units
                    </button>
                    <p style="margin-top: 10px; opacity: 0.8; font-size: 0.9rem;">
                        é»æ“Šæ­¤æŒ‰éˆ•å°‡è‡ªå‹•å¡«å…¥å»ºè­°çš„è¨‚è³¼æ•¸é‡<br>
                        Click to automatically fill in the suggested order quantity
                    </p>
                </div>`;

            return reasoning + costAnalysis + actionButton;
        }

        function generateDoraemonShortageStrategy(backorder, wholesalerOrder, targetInventory, totalInPipeline, suggestedOrder) {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-size: 1.4rem;">
                        ğŸš¨ <span>ç·Šæ€¥ï¼ä½¿ç”¨ç«¹èœ»èœ“å¿«é€Ÿè£œè²¨ç­–ç•¥ï¼</span>
                    </h4>
                    <h5 style="margin-bottom: 10px; opacity: 0.9; font-size: 1.1rem;">
                        Emergency! Use Bamboo-copter Fast Restocking Strategy!
                    </h5>
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; margin-bottom: 15px; border: 2px solid rgba(255,255,255,0.4);">
                        <p style="font-size: 1.3rem; font-weight: 800; margin-bottom: 10px; text-align: center;">
                            ğŸ¯ <strong>å¤šå•¦Aå¤¢å»ºè­°ç«‹å³è¨‚è³¼ ${suggestedOrder} å€‹ç¥å¥‡å–®ä½ï¼</strong>
                        </p>
                        <p style="font-size: 1.1rem; font-weight: 600; text-align: center; opacity: 0.9;">
                            Doraemon suggests ordering ${suggestedOrder} magic units immediately!
                        </p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸ¤– <span>å¤šå•¦Aå¤¢çš„ç¥å¥‡åˆ†æ</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸš¨ ç·Šæ€¥è£œè¶³ç¼ºè²¨ï¼š${backorder} å–®ä½</li>
                                <li>ğŸª æ»¿è¶³æ‰¹ç™¼å•†éœ€æ±‚ï¼š${wholesalerOrder} å–®ä½</li>
                                <li>ğŸ›¡ï¸ å»ºç«‹å®‰å…¨é˜²è­·åº«å­˜ï¼š${targetInventory} å–®ä½</li>
                                <li>â° æ™‚å…‰æ©Ÿåœ¨é€”è²¨ç‰©ï¼š${totalInPipeline} å–®ä½</li>
                                <li><strong style="color: var(--doraemon-yellow);">ğŸ”¥ å±éšªç­‰ç´šï¼šéå¸¸é«˜ï¼</strong></li>
                            </ul>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸŒŸ <span>Doraemon's Magic Analysis</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸš¨ Emergency shortage cover: ${backorder} units</li>
                                <li>ğŸª Meet wholesaler demand: ${wholesalerOrder} units</li>
                                <li>ğŸ›¡ï¸ Build safety stock: ${targetInventory} units</li>
                                <li>â° Time machine pipeline: ${totalInPipeline} units</li>
                                <li><strong style="color: var(--doraemon-yellow);">ğŸ”¥ Risk Level: Very High!</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>`;
        }

        function generateDoraemonReplenishmentStrategy(shortfall, avgDemand, totalInPipeline, suggestedOrder) {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-size: 1.4rem;">
                        ğŸ“ˆ <span>ä½¿ç”¨æ”¾å¤§é¡ç²¾æ˜è£œè²¨ç­–ç•¥ï¼</span>
                    </h4>
                    <h5 style="margin-bottom: 10px; opacity: 0.9; font-size: 1.1rem;">
                        Use Magnifying Glass Smart Replenishment Strategy!
                    </h5>
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; margin-bottom: 15px; border: 2px solid rgba(255,255,255,0.4);">
                        <p style="font-size: 1.3rem; font-weight: 800; margin-bottom: 10px; text-align: center;">
                            ğŸ’¡ <strong>å¤šå•¦Aå¤¢å»ºè­°é©åº¦è¨‚è³¼ ${suggestedOrder} å€‹ç¥å¥‡å–®ä½ï¼</strong>
                        </p>
                        <p style="font-size: 1.1rem; font-weight: 600; text-align: center; opacity: 0.9;">
                            Doraemon suggests moderate ordering of ${suggestedOrder} magic units!
                        </p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸ” <span>æ”¾å¤§é¡ç²¾æº–åˆ†æ</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸ“‰ è£œè¶³åº«å­˜ç¼ºå£ï¼š${shortfall} å–®ä½</li>
                                <li>ğŸ“Š é æœŸå¹³å‡éœ€æ±‚ï¼š${Math.ceil(avgDemand)} å–®ä½</li>
                                <li>ğŸš€ æ™‚å…‰æ©Ÿåœ¨é€”ï¼š${totalInPipeline} å–®ä½</li>
                                <li>âš–ï¸ é¢¨éšªè©•ä¼°ï¼šä¸­ç­‰</li>
                                <li><strong style="color: var(--doraemon-green);">ğŸ¯ ç­–ç•¥ï¼šç©©å¥è£œè²¨</strong></li>
                            </ul>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸ” <span>Precise Analysis</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸ“‰ Fill inventory gap: ${shortfall} units</li>
                                <li>ğŸ“Š Expected avg demand: ${Math.ceil(avgDemand)} units</li>
                                <li>ğŸš€ Time machine pipeline: ${totalInPipeline} units</li>
                                <li>âš–ï¸ Risk assessment: Medium</li>
                                <li><strong style="color: var(--doraemon-green);">ğŸ¯ Strategy: Stable restocking</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>`;
        }

        function generateDoraemonCostControlStrategy(inventory, avgDemand, totalInPipeline, suggestedOrder) {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-size: 1.4rem;">
                        ğŸ’° <span>ä½¿ç”¨ç¸®å°ç‡ˆç¯€ç´„æˆæœ¬ç­–ç•¥ï¼</span>
                    </h4>
                    <h5 style="margin-bottom: 10px; opacity: 0.9; font-size: 1.1rem;">
                        Use Shrinking Light Cost Saving Strategy!
                    </h5>
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; margin-bottom: 15px; border: 2px solid rgba(255,255,255,0.4);">
                        <p style="font-size: 1.3rem; font-weight: 800; margin-bottom: 10px; text-align: center;">
                            ğŸ¯ <strong>å¤šå•¦Aå¤¢å»ºè­°ä¿å®ˆè¨‚è³¼ ${suggestedOrder} å€‹ç¥å¥‡å–®ä½ï¼</strong>
                        </p>
                        <p style="font-size: 1.1rem; font-weight: 600; text-align: center; opacity: 0.9;">
                            Doraemon suggests conservative ordering of ${suggestedOrder} magic units!
                        </p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸ’ <span>ç¸®å°ç‡ˆæˆæœ¬æ§åˆ¶</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸ“¦ å››æ¬¡å…ƒå£è¢‹åº«å­˜ï¼š${inventory} å–®ä½ï¼ˆå……è¶³ï¼‰</li>
                                <li>ğŸ“ˆ é æœŸå¸‚å ´éœ€æ±‚ï¼š${Math.ceil(avgDemand)} å–®ä½</li>
                                <li>â° æ™‚å…‰æ©Ÿåœ¨é€”å­˜è²¨ï¼š${totalInPipeline} å–®ä½</li>
                                <li>ğŸ’¸ æˆæœ¬é¢¨éšªç­‰ç´šï¼šä½</li>
                                <li><strong style="color: var(--doraemon-yellow);">ğŸ¯ é‡é»ï¼šé™ä½åº«å­˜æˆæœ¬</strong></li>
                            </ul>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸ’ <span>Cost Control Analysis</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸ“¦ 4D Pocket inventory: ${inventory} units (sufficient)</li>
                                <li>ğŸ“ˆ Expected market demand: ${Math.ceil(avgDemand)} units</li>
                                <li>â° Time machine pipeline: ${totalInPipeline} units</li>
                                <li>ğŸ’¸ Cost risk level: Low</li>
                                <li><strong style="color: var(--doraemon-yellow);">ğŸ¯ Focus: Reduce inventory costs</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>`;
        }

        function generateDoraemonStableStrategy(avgDemand, targetInventory, inventory, totalInPipeline, suggestedOrder) {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-size: 1.4rem;">
                        âš–ï¸ <span>ä½¿ç”¨å¤©å¹³ä¿æŒå®Œç¾å¹³è¡¡ç­–ç•¥ï¼</span>
                    </h4>
                    <h5 style="margin-bottom: 10px; opacity: 0.9; font-size: 1.1rem;">
                        Use Balance Scale Perfect Equilibrium Strategy!
                    </h5>
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; margin-bottom: 15px; border: 2px solid rgba(255,255,255,0.4);">
                        <p style="font-size: 1.3rem; font-weight: 800; margin-bottom: 10px; text-align: center;">
                            âœ… <strong>å¤šå•¦Aå¤¢å»ºè­°ç©©å®šè¨‚è³¼ ${suggestedOrder} å€‹ç¥å¥‡å–®ä½ï¼</strong>
                        </p>
                        <p style="font-size: 1.1rem; font-weight: 600; text-align: center; opacity: 0.9;">
                            Doraemon suggests stable ordering of ${suggestedOrder} magic units!
                        </p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸŒŸ <span>ç¥å¥‡å¹³è¡¡æŒ‡å—</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸ“Š é æœŸå¸‚å ´éœ€æ±‚ï¼š${Math.ceil(avgDemand)} å–®ä½</li>
                                <li>ğŸ“ˆ åº«å­˜ç‹€æ…‹èª¿æ•´ï¼š${targetInventory - inventory} å–®ä½</li>
                                <li>ğŸš€ æ™‚å…‰éš§é“ä¾›æ‡‰ï¼š${totalInPipeline} å–®ä½</li>
                                <li>ğŸ”„ é‹ç‡Ÿç‹€æ…‹ï¼šå®Œç¾å¹³è¡¡</li>
                                <li><strong style="color: var(--doraemon-blue);">ğŸ¯ ç›®æ¨™ï¼šç¶­æŒç¥å¥‡å¹³è¡¡</strong></li>
                            </ul>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸŒŸ <span>Magic Balance Guide</span>
                            </h5>
                            <ul style="margin: 0; padding-left: 20px; line-height: 2;">
                                <li>ğŸ“Š Expected market demand: ${Math.ceil(avgDemand)} units</li>
                                <li>ğŸ“ˆ Inventory adjustment: ${targetInventory - inventory} units</li>
                                <li>ğŸš€ Time tunnel supply: ${totalInPipeline} units</li>
                                <li>ğŸ”„ Operation status: Perfect balance</li>
                                <li><strong style="color: var(--doraemon-blue);">ğŸ¯ Goal: Maintain magic balance</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>`;
        }

        function generateDoraemonCostAnalysis(currentCost, inventory, delay1, delay2, backorder) {
            return `
                <div style="margin-top: 25px; padding-top: 20px; border-top: 3px solid rgba(255,255,255,0.4);">
                    <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-size: 1.4rem;">
                        ğŸ”® <span>è©³ç´°æˆæœ¬åˆ†æå ±å‘Šï¼</span>
                    </h4>
                    <h5 style="margin-bottom: 15px; opacity: 0.9; font-size: 1.1rem;">
                        Detailed Cost Analysis Report!
                    </h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸ’° <span>ä¸­æ–‡æˆæœ¬æ˜ç´°</span>
                            </h5>
                            <div style="line-height: 2; font-size: 0.95rem;">
                                <p><strong>ğŸ† æœ¬é€±é ä¼°ç¸½æˆæœ¬ï¼š${currentCost.toFixed(1)} å…ƒ</strong></p>
                                <p>â”œâ”€ ğŸ’ åº«å­˜æŒæœ‰æˆæœ¬ï¼š${((inventory + delay1 + delay2) * 0.5).toFixed(1)} å…ƒ</p>
                                <p>â”‚  â”œâ”€ ğŸ“¦ åº«å­˜ï¼š${inventory} Ã— 0.5 = ${(inventory * 0.5).toFixed(1)} å…ƒ</p>
                                <p>â”‚  â”œâ”€ â° å»¶é²1ï¼š${delay1} Ã— 0.5 = ${(delay1 * 0.5).toFixed(1)} å…ƒ</p>
                                <p>â”‚  â””â”€ âŒ› å»¶é²2ï¼š${delay2} Ã— 0.5 = ${(delay2 * 0.5).toFixed(1)} å…ƒ</p>
                                <p>â””â”€ ğŸš¨ ç¼ºè²¨æ‡²ç½°æˆæœ¬ï¼š${(backorder * 1.0).toFixed(1)} å…ƒ</p>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);">
                            <h5 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                                ğŸ’° <span>English Cost Breakdown</span>
                            </h5>
                            <div style="line-height: 2; font-size: 0.95rem;">
                                <p><strong>ğŸ† Weekly estimated total cost: ${currentCost.toFixed(1)}</strong></p>
                                <p>â”œâ”€ ğŸ’ Inventory holding cost: ${((inventory + delay1 + delay2) * 0.5).toFixed(1)}</p>
                                <p>â”‚  â”œâ”€ ğŸ“¦ Inventory: ${inventory} Ã— 0.5 = ${(inventory * 0.5).toFixed(1)}</p>
                                <p>â”‚  â”œâ”€ â° Delay1: ${delay1} Ã— 0.5 = ${(delay1 * 0.5).toFixed(1)}</p>
                                <p>â”‚  â””â”€ âŒ› Delay2: ${delay2} Ã— 0.5 = ${(delay2 * 0.5).toFixed(1)}</p>
                                <p>â””â”€ ğŸš¨ Shortage penalty cost: ${(backorder * 1.0).toFixed(1)}</p>
                            </div>
                        </div>
                    </div>
                </div>`;
        }

        function processWeek() {
            const wholesalerOrder = parseInt(document.getElementById('wholesalerOrder').value);
            const actualShip = parseInt(document.getElementById('actualShip').value);
            const myOrder = parseInt(document.getElementById('myOrder').value);
            const newInventory = parseInt(document.getElementById('newInventory').value);
            const newDelay1 = parseInt(document.getElementById('newDelay1').value);
            const newDelay2 = parseInt(document.getElementById('newDelay2').value);

            // è¼¸å…¥é©—è­‰
            if ([wholesalerOrder, actualShip, newInventory, newDelay1, newDelay2].some(val => isNaN(val))) {
                showDoraemonAlert('ğŸ¤– å¤šå•¦Aå¤¢æé†’ï¼šè«‹å¡«å…¥æ‰€æœ‰åŸºç¤æ•¸æ“šï¼\nDoraemon reminds: Please fill in all basic data!', 'warning');
                return;
            }
            
            if (isNaN(myOrder)) {
                showDoraemonAlert('ğŸ¤– å¤šå•¦Aå¤¢æé†’ï¼šè«‹æ±ºå®šå·¥å» è¨‚è³¼æ•¸é‡ï¼å»ºè­°å…ˆé»æ“ŠAIå»ºè­°\nDoraemon reminds: Please decide factory order quantity! Try AI suggestion first', 'warning');
                return;
            }

            // è¨ˆç®—æ–°ç‹€æ…‹
            const newBackorder = Math.max(0, gameState.backorder + wholesalerOrder - actualShip);
            const weeklyCost = calculateCost(newInventory, newDelay1, newDelay2, newBackorder);

            // æ›´æ–°éŠæˆ²ç‹€æ…‹
            gameState.currentWeek++;
            gameState.inventory = newInventory;
            gameState.delay1 = newDelay1;
            gameState.delay2 = newDelay2;
            gameState.backorder = newBackorder;
            gameState.weeklyCost = weeklyCost;
            gameState.totalCost += weeklyCost;

            // è¨˜éŒ„æ­·å²
            gameState.history.push({
                week: gameState.currentWeek,
                wholesalerOrder: wholesalerOrder,
                actualShip: actualShip,
                myOrder: myOrder,
                inventory: newInventory,
                delay1: newDelay1,
                delay2: newDelay2,
                backorder: newBackorder,
                weeklyCost: weeklyCost,
                totalCost: gameState.totalCost
            });

            // æ›´æ–°é¡¯ç¤º
            updateDisplay();
            updateProgressBar();
            updateHistoryTable();
            
            // éš±è—AIå»ºè­°
            document.getElementById('aiSuggestion').style.display = 'none';
            clearInputs();

            // æª¢æŸ¥éŠæˆ²çµæŸ
            if (gameState.currentWeek >= 60) {
                setTimeout(() => {
                    showDoraemonGameEnd();
                }, 500);
                return;
            }

            // é¡¯ç¤ºè™•ç†æˆåŠŸæç¤º
            showDoraemonAlert(`âœ… ç¬¬${gameState.currentWeek}é€±æ•¸æ“šè™•ç†å®Œæˆï¼\nâœ… Week ${gameState.currentWeek} data processed successfully!`, 'success');
        }

        function showDoraemonAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'doraemon-alert';
            alertDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">ğŸ¤–</span>
                    <div style="font-weight: 600;">${message}</div>
                </div>
            `;
            
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 4000);
        }

        function showDoraemonGameEnd() {
            const endMessage = `
                ğŸ‰ æ­å–œï¼å¤šå•¦Aå¤¢çš„ä¾›æ‡‰éˆå†’éšªå®Œæˆäº†ï¼ ğŸ‰
                Congratulations! Doraemon's Supply Chain Adventure Complete!
                
                ğŸ† æœ€çµ‚çµ±è¨ˆ Final Statistics:
                â€¢ 60é€±ç¸½æˆæœ¬ Total Cost: ${gameState.totalCost.toFixed(1)} å…ƒ/$
                â€¢ å¹³å‡é€±æˆæœ¬ Average Weekly Cost: ${(gameState.totalCost/60).toFixed(1)} å…ƒ/$
                
                ğŸ¤– å¤šå•¦Aå¤¢èªªï¼šã€Œä½ åšå¾—å¾ˆæ£’ï¼ä¾›æ‡‰éˆç®¡ç†çœŸæ˜¯ç¥å¥‡çš„å­¸å•å‘¢ï¼ã€
                Doraemon says: "You did great! Supply chain management is truly amazing!"
                
                âœ¨ è¬è¬ä½ å’Œå¤šå•¦Aå¤¢ä¸€èµ·å­¸ç¿’ï¼ Thank you for learning with Doraemon! âœ¨
            `;
            alert(endMessage);
        }

        function updateHistoryTable() {
            const tbody = document.getElementById('historyTableBody');
            tbody.innerHTML = `<tr>
                <td>0</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>4</td>
                <td>4</td>
                <td>4</td>
                <td>0</td>
                <td>6.0</td>
                <td>6.0</td>
            </tr>`;

            gameState.history.forEach(record => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${record.week}</td>
                    <td>${record.wholesalerOrder}</td>
                    <td>${record.actualShip}</td>
                    <td>${record.myOrder !== null ? record.myOrder : '-'}</td>
                    <td>${record.inventory}</td>
                    <td>${record.delay1}</td>
                    <td>${record.delay2}</td>
                    <td>${record.backorder}</td>
                    <td>${record.weeklyCost.toFixed(1)}</td>
                    <td>${record.totalCost.toFixed(1)}</td>
                `;
            });
        }

        function clearInputs() {
            ['wholesalerOrder', 'actualShip', 'newInventory', 'newDelay1', 'newDelay2'].forEach(id => {
                const input = document.getElementById(id);
                input.value = '';
                input.style.transform = 'scale(0.9)';
                setTimeout(() => {
                    input.style.transform = 'scale(1)';
                }, 200);
            });
            
            // æ¸…ç©ºè¨‚å–®è¼¸å…¥ï¼Œä½†ä¸åšå‹•ç•«ï¼ˆå› ç‚ºé€™æ˜¯æ±ºç­–æ€§è¼¸å…¥ï¼‰
            document.getElementById('myOrder').value = '';
        }

        function resetGame() {
            const confirmMessage = 'ğŸ¤– å¤šå•¦Aå¤¢å•ï¼šç¢ºå®šè¦é‡æ–°é–‹å§‹éŠæˆ²å—ï¼Ÿ\nDoraemon asks: Are you sure to restart the game?';
            
            if (confirm(confirmMessage)) {
                // é‡ç½®éŠæˆ²ç‹€æ…‹
                gameState = {
                    currentWeek: 0,
                    inventory: 4,
                    delay1: 4,
                    delay2: 4,
                    backorder: 0,
                    weeklyCost: 6.0,
                    totalCost: 6.0,
                    history: []
                };
                
                // æ›´æ–°æ‰€æœ‰é¡¯ç¤º
                updateDisplay();
                updateProgressBar();
                updateHistoryTable();
                clearInputs();
                setDefaultWeekData();
                
                // éš±è—AIå»ºè­°
                document.getElementById('aiSuggestion').style.display = 'none';
                
                // é¡¯ç¤ºé‡ç½®æˆåŠŸæç¤º
                showDoraemonAlert('ğŸ”„ éŠæˆ²é‡æ–°é–‹å§‹ï¼Game restarted!', 'success');
            }
        }

        function showGameHelp() {
            const helpContent = `
                ğŸ¤– å¤šå•¦Aå¤¢çš„ä¾›æ‡‰éˆç®¡ç†æŒ‡å— | Doraemon's Supply Chain Management Guide
                
                ğŸ“š æ“ä½œæ­¥é©Ÿ Operation Steps:
                1ï¸âƒ£ è§€å¯Ÿç•¶å‰ç‹€æ…‹ Check current status (åº«å­˜ã€å»¶é²ç­‰)
                2ï¸âƒ£ è¼¸å…¥æ¯é€±æ•¸æ“š Input weekly data (è¨‚å–®ã€å‡ºè²¨ç­‰)
                3ï¸âƒ£ ä½¿ç”¨ã€ŒAIå»ºè­°ã€ç²å¾—ç­–ç•¥ Use "AI Suggestion" for strategy
                4ï¸âƒ£ é»æ“Šã€Œæ–½å±•é­”æ³•ã€è™•ç† Click "Cast Magic" to process
                5ï¸âƒ£ é‡è¤‡60é€±å®ŒæˆæŒ‘æˆ° Repeat for 60 weeks to complete
                
                ğŸ¯ éŠæˆ²ç›®æ¨™ï¼šæœ€å°åŒ–60é€±ç¸½æˆæœ¬ï¼
                ğŸ¯ Game Goal: Minimize total cost over 60 weeks!
                
                ğŸ’¡ é‡è¦æé†’ï¼šæ¯å€‹æ±ºç­–éƒ½æœƒå½±éŸ¿æœªä¾†å¹¾é€±çš„æˆæœ¬ï¼
                ğŸ’¡ Important: Every decision affects costs for future weeks!
            `;
            alert(helpContent);
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // é é¢è¼‰å…¥å®Œæˆå¾ŒåŸ·è¡Œ
        updateDisplay();
        updateProgressBar();
    </script>
</body>
</html>
